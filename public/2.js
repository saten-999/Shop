(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{10:function(t,e,s){var n=s(35);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};s(3)(n,o);n.locals&&(t.exports=n.locals)},26:function(t,e,s){"use strict";var n=s(6);s.n(n).a},27:function(t,e,s){(t.exports=s(2)(!1)).push([t.i,".messagesend{left:104px}#adm .messagesend,.messagesend{background-color:#ff0;width:70%;position:relative}#adm .messagesend{left:223px}.messagereseved{background-color:#7fffd4;width:70%;margin-left:5px}.feed{height:100%;max-height:300px;overflow-y:scroll}.feed li{list-style:none;border:1px solid grey;padding:5px;margin-top:5px}ul{padding:0}",""])},28:function(t,e,s){"use strict";var n=s(7);s.n(n).a},29:function(t,e,s){(t.exports=s(2)(!1)).push([t.i,".composer{top:0}textarea{width:100%}",""])},30:function(t,e,s){"use strict";var n=s(8);s.n(n).a},31:function(t,e,s){(t.exports=s(2)(!1)).push([t.i,".conversation{width:70%}",""])},32:function(t,e,s){"use strict";var n=s(9);s.n(n).a},33:function(t,e,s){(t.exports=s(2)(!1)).push([t.i,".contact-list{overflow-y:scroll;height:300px;width:30%}.contact-list ul{list-style:none;padding:0}.contact-list li{border:1px solid grey;padding:5px;margin:5px}.selected{background-color:#f0f8ff}.unread{background-color:#3cb371;color:#fff;border-radius:50%;padding:1px 6px;float:right}",""])},34:function(t,e,s){"use strict";var n=s(10);s.n(n).a},35:function(t,e,s){(t.exports=s(2)(!1)).push([t.i,".chat-admin{display:flex}",""])},6:function(t,e,s){var n=s(27);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};s(3)(n,o);n.locals&&(t.exports=n.locals)},65:function(t,e,s){"use strict";s.r(e);var n={props:{contact:{type:Object},messages:{type:Array}},methods:{scrollToBottom:function(){var t=this;setTimeout((function(){t.$refs.feed.scrollTop=t.$refs.feed.scrollHeight-t.$refs.feed.clientHeight}),50)}},watch:{contact:function(t){this.scrollToBottom()},messages:function(t){this.scrollToBottom()}}},o=(s(26),s(0)),a=Object(o.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"feed",staticClass:"feed"},[t.contact?s("ul",{attrs:{id:"adm"}},t._l(t.messages,(function(e){return s("li",{key:e.id,class:"message"+(e.to==t.contact.id?"send":"reseved")},[s("div",{staticClass:"text"},[t._v("\n                "+t._s(e.text)+"\n            ")])])})),0):t._e()])}),[],!1,null,null,null).exports,c={data:function(){return{message:""}},methods:{send:function(t){t.preventDefault(),""!=this.message&&(this.$emit("send",this.message),this.message="")}}},i=(s(28),Object(o.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"composer"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{placeholder:"Message..."},domProps:{value:t.message},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}})])}),[],!1,null,null,null).exports),r={props:{contact:{type:Object,default:null},messages:{type:Array}},data:function(){return{}},methods:{sendmessage:function(t){var e=this;this.contact&&axios.post("/admin/conversation/send",{contact_id:this.contact.id,text:t}).then((function(t){e.$emit("new",t.data)}))}},components:{messagesFeed:a,messageComposer:i}},l=(s(30),Object(o.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"conversation"},[s("h5",[t._v(t._s(t.contact?t.contact.name:"Select a Contact"))]),t._v(" "),s("messagesFeed",{attrs:{contact:t.contact,messages:t.messages}}),t._v(" "),t.contact?s("messageComposer",{on:{send:t.sendmessage}}):t._e()],1)}),[],!1,null,null,null).exports),d={props:{contacts:{type:Array,default:[]}},data:function(){return{selected:this.contacts.length?this.contacts[0]:null}},methods:{selectContact:function(t){this.selected=t,this.$emit("selected",t)}},computed:{sortedContact:function(){var t=this;return _.sortBy(this.contacts,[function(e){return e==t.selected?1/0:e.unread}]).reverse()}}},u=(s(32),Object(o.a)(d,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"contact-list"},[s("ul",t._l(t.sortedContact,(function(e){return s("li",{key:e.id,class:{selected:e==t.selected},on:{click:function(s){return t.selectContact(e)}}},[t._v("\n            "+t._s(e.name)+" \n            "),s("br"),t._v("\n            "+t._s(e.email)+"\n            "),e.unread?s("span",{staticClass:"unread"},[t._v("\n            "+t._s(e.unread)+"\n            ")]):t._e()])})),0)])}),[],!1,null,null,null).exports),f={props:{user:{type:Object,required:!0}},data:function(){return{selectedContact:null,messages:[],contacts:[]}},methods:{startConversationWith:function(t){var e=this;this.updateUnreadCount(t,!0),axios.get("/admin/conversation/".concat(t.id)).then((function(s){e.messages=s.data,e.selectedContact=t}))},saveNewMessage:function(t){this.messages.push(t)},handleIncoming:function(t){this.selectedContact&&t.from==this.selectedContact.id?this.saveNewMessage(t):this.updateUnreadCount(t.from_contact,!1)},updateUnreadCount:function(t,e){var s=this;this.contacts=this.contacts.map((function(n){return n.id!=t.id||(e?(n.unread=0,axios.put("/admin/conversation/update/".concat(n.id,"/").concat(s.user.id)).then((function(t){}))):n.unread++),n}))}},mounted:function(){var t=this;window.Echo.private("messages.".concat(this.user.id)).listen("MessageSentEvent",(function(e){t.handleIncoming(e.message)})),axios.get("/admin/contacts").then((function(e){t.contacts=e.data}))},components:{conversation:l,contactList:u}},m=(s(34),Object(o.a)(f,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"chat-admin"},[e("conversation",{attrs:{contact:this.selectedContact,messages:this.messages},on:{new:this.saveNewMessage}}),this._v(" "),e("contactList",{attrs:{contacts:this.contacts},on:{selected:this.startConversationWith}})],1)}),[],!1,null,null,null));e.default=m.exports},7:function(t,e,s){var n=s(29);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};s(3)(n,o);n.locals&&(t.exports=n.locals)},8:function(t,e,s){var n=s(31);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};s(3)(n,o);n.locals&&(t.exports=n.locals)},9:function(t,e,s){var n=s(33);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};s(3)(n,o);n.locals&&(t.exports=n.locals)}}]);